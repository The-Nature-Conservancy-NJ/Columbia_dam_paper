"0","columbia_hab_data <- hab %>%"
"0","  filter(tnc_code %in% sites) %>%"
"0","  #filter(tnc_code %in% sites, year >= 2016, year <= 2024) %>%"
"0","  group_by(tnc_code, year) %>%"
"0","  summarize(habitat_score = mean(habitat_score)) %>%"
"0","  mutate(col = case_when(habitat_score >= 160 ~ color_vector[1],"
"0","                            habitat_score < 160 & "
"0","                              habitat_score >= 110 ~ color_vector[2],"
"0","                            habitat_score < 110 &"
"0","                              habitat_score >= 60 ~ color_vector[3],"
"0","                            habitat_score < 60 ~ color_vector[4]))"
"0",""
"0","#order by upstream-downstream order"
"0","columbia_hab_data$tnc_code <- factor(columbia_hab_data$tnc_code, levels = c(""TNC_23"", ""TNC_80"", ""TNC_25""))"
"0","#reorder so that TNC_80 plots on top of TNC_25"
"0","columbia_hab_data <- columbia_hab_data[order(-as.numeric(factor(columbia_hab_data$tnc_code))),]"
"0","  "
"0",""
"0","stage_bounds <- data.frame("
"0","  xmin = c(2018),"
"0","  xmax = c(2020),"
"0","  stage = c(""During Removal"")"
"0",")"
"0",""
"0","left_pad <- theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 25))"
"0",""
"0","plot_hab <- columbia_hab_data %>%"
"0","ggplot() +"
"0","   geom_rect(data = stage_bounds, aes(xmin = xmin, xmax = xmax, ymin = -Inf, ymax = Inf, show.legend = FALSE), alpha = 0.3)+"
"0","   geom_hline(yintercept = 160, lty = 3, color = color_vector[1],"
"0","              alpha = 0.75) +"
"0","  annotate(""text"", x = 2016.2, y = 160+3, vjust = 0, hjust = 0.4,"
"0","            label = ""Optimal"","
"0","            angle = 0, color = color_vector[1],"
"0","            size = 2.5,"
"0","              alpha = 0.75) +"
"0","   geom_hline(yintercept = 110, lty = 3, color = color_vector[2],"
"0","              alpha = 0.75) +"
"0","   annotate(""text"", x = 2016.6, y = 110+3, vjust = 0, hjust = 0.5,"
"0","            label = ""Sub-Optimal"","
"0","            angle = 0, color = color_vector[2],"
"0","            size = 2.5,"
"0","              alpha = 0.75) +"
"0","   geom_hline(yintercept = 60, lty = 3, color = color_vector[3],"
"0","              alpha = 0.75) +"
"0","   annotate(""text"", x = 2016.4, y = 60+3, vjust = 0, hjust = 0.5,"
"0","            label = ""Marginal"","
"0","            angle = 0, color = color_vector[3],"
"0","            size = 2.5,"
"0","              alpha = 0.75) +"
"0","   geom_hline(yintercept = 0, lty = 3, color = color_vector[4],"
"0","              alpha = 0.75) +"
"0","   annotate(""text"", x = 2016.2, y = 3, vjust = 0, hjust = 0.5,"
"0","            label = ""Poor"","
"0","            angle = 0, color = color_vector[4],"
"0","            size = 2.5,"
"0","              alpha = 0.75) +"
"0","   geom_line(data = columbia_hab_data, aes(x = year, y = habitat_score, lty = tnc_code), "
"0","             size = .75, alpha = 1, color = ""grey50"") +"
"0","   geom_point(data = columbia_hab_data, aes(x = year, y = habitat_score, fill = tnc_code), "
"0","             size = 4, shape = 21) +"
"0","    scale_y_continuous(limits = c(0, 200)) +"
"0","    scale_fill_manual(values = c(""white"", "
"0","                                  ""grey50"", "
"0","                                 ""black"", ""grey60"")) +"
"0","     theme_classic() +"
"0","     theme(text = element_text(size = 14)) +"
"0","     labs(y = ""Habitat Score"", x = """", fill = """", lty = """")+"
"0","   scale_linetype_manual(values = c(""TNC_23"" = ""solid"", ""TNC_80"" = ""dashed"", ""TNC_25"" = ""longdash""), guide = ""none"")+"
"0","  left_pad+"
"0","  coord_cartesian(clip = ""off"")"
"0","  "
"0","ggsave(here::here(""output/Columbia_paper_figs_analysis/"","
"0","                  ""Fig5B_hab_by_year_Columbia_Dam.png""),"
"0","                  height = 4, width = 6, dpi = 400)"
