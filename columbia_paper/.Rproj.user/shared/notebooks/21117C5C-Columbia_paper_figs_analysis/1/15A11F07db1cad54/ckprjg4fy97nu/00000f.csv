"0","#site number for blairstown, pCode for discharge, change start and end date to encompass desired dates"
"0","siteNo <- ""01443500"""
"0","pCode <- ""00060"""
"0","start.date <- ""2016-01-01"""
"0","end.date <- ""2024-12-01"""
"0",""
"0","#create datafile"
"0","usgs <- readNWISuv(siteNumbers = siteNo, "
"0","                   parameterCd = pCode,"
"0","                   startDate = start.date,"
"0","                   endDate = end.date)"
"0",""
"0","#separate date and time"
"0","usgs$date <- format(as.POSIXct(usgs$dateTime, format = ""%Y-%m-%d %H:%M:%S""), ""%Y-%m-%d"")"
"0",""
"0","usgs$time <- format(as.POSIXct(usgs$dateTime, format = ""%Y-%m-%d %H:%M:%S""), ""%H:%M:%S"")"
"0",""
"0","#take maximum for each day"
"0","max_day_flow <- usgs %>%"
"0","  group_by(date) %>%"
"0","  summarize(max = max(X_00060_00000))"
"0",""
"0","#subset to desired date range- maximum discharge for each day"
"0","f <- subset(max_day_flow, date >= ""2025-05-14"" & date <= ""2025-05-28"")"
"0",""
"0","#average of maximum discharge from date range"
"0","mean(f$max)"
"1","[1]"
"1"," NaN"
"1","
"
"0","max_day_flow_plot <- max_day_flow"
"0","max_day_flow_plot$month <- month(max_day_flow_plot$date, label = TRUE, abbr = TRUE)"
"0","max_day_flow_plot$year <- format(as.POSIXct(max_day_flow_plot$date, format = ""%Y-%m-%d""), ""%Y"")"
"0","#max_day_flow_plot <- max_day_flow_plot %>%"
"0","  #filter(month %in% c(""May"", ""Jun"", ""Jul"", ""Aug"", ""Sep""))"
"0","#max_day_flow_plot$monthyear <- paste(max_day_flow_plot$month, max_day_flow_plot$year, sep = "" "")"
"0",""
"0","max_day_flow_month <- max_day_flow_plot %>%"
"0","  group_by(month, year) %>%"
"0","  summarize("
"0","    mean_max = mean(max, na.rm = TRUE),"
"0","    sd_max = sd(max, na.rm = TRUE),"
"0","    n = sum(!is.na(max))"
"0","  )"
"0","max_day_flow_month$sterr <- max_day_flow_month$sd_max/(sqrt(max_day_flow_month$n))"
"0",""
"0","stage_bounds_usgs <- data.frame("
"0","  xmin = c(6, 6, 5, 4, 6, 5, 5, 5, 5),"
"0","  xmax = c(12, 11, 11, 11, 9, 10, 10, 10, 10),"
"0","  year = c(2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024)"
"0",")"
"0","  "
"0","ggplot() +"
"0","  geom_rect(data = stage_bounds_usgs, aes(xmin = xmin, xmax = xmax, ymin = -Inf, ymax = Inf), alpha = 0.3, show.legend = FALSE)+"
"0","   geom_point(data = max_day_flow_month, aes(x = month, y = mean_max), color = ""black"", size = 1) +"
"0","   geom_line(data = max_day_flow_month, aes(x = month, y = mean_max), group = 1)+"
"0","   geom_errorbar(data = max_day_flow_month, aes(x = month, ymin = (mean_max - sterr), ymax = (mean_max + sterr)), width = 0.2)+"
"0","   labs(x = """", y = ""Mean Daily Maximum Discharge (CFS)"")+"
"0","   facet_wrap(~year)+"
"0","   theme_classic()+"
"0","   theme(axis.text.x = element_text(angle = 90, hjust = 1))+"
"0","  scale_fill_manual(values = ""grey60"")"
