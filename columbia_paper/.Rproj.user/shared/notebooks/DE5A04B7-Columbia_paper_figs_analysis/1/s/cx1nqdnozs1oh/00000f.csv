"0","# format temperature data of Columbia Dam site for JAGS"
"0","colt_jags <- col %>% "
"0","  filter(is.na(d25.23) == F,"
"0","         monthf %in% 5:9) %>%"
"0","  droplevels()"
"0",""
"0","cov_matrix <- model.matrix(d25.23 ~ stage + monthf, data = colt_jags)[, -1]"
"0","K <- ncol(cov_matrix)"
"0",""
"0","colt_jags_data <- list("
"0","  N = nrow(colt_jags),"
"0","  K = K,"
"0","  tdiff = colt_jags$d25.23,"
"0","  stage = as.numeric(as.character(colt_jags$stage)),"
"0","  year = as.numeric(colt_jags$yearf),"
"0","  month = as.numeric(as.character(colt_jags$monthf)),"
"0","  cov.mat = cov_matrix"
"0","  )"
"0",""
"0","cat(file = ""scripts/columbia_baci.txt"", "
"0",""""
"0","model{"
"0",""
"0","  # likelihood"
"0","  for( i in 1:N ){"
"0","  tdiff[i] ~ dnorm(mu[i], tau[stage[i]])"
"0","  mu[i] <- beta0 + inprod(beta.cov[], cov.mat[i,])"
"0",""
"0","  }"
"0","  "
"0","  # priors"
"0","  beta0 ~ dnorm(0, 1.0E-06)"
"0","  "
"0","  for( s in 1:3 ) {"
"0","  tau[s] ~ dgamma(1, 1)"
"0","  }"
"0","  "
"0","  for( k in 1:K ){ "
"0","  beta.cov[k] ~ dnorm(0, 1.0E-06)"
"0","  }"
"0","  "
"0","  # derrived"
"0","  for (k in 3:K) {"
"0","    place[k] <- beta.cov[k]"
"0","  }"
"0","  "
"0","  mean_month <- sum(place[3:K]) / (K-2)"
"0","  "
"0","  mean_pre <- beta0 + mean_month"
"0","  mean_dur <- beta0 + beta.cov[1] + mean_month"
"0","  mean_post <- beta0 + beta.cov[2] + mean_month"
"0","  ba_diff <- mean_post - mean_pre"
"0",""
"0","  for(s in 1:3){"
"0","  sigma[s] <- pow(tau[s], -0.5)"
"0","  }"
"0","  "
"0","  sig_diff <- sigma[3] - sigma[1]"
"0","  "
"0","}"
"0",""""
"0",")"
"0",""
"0","colt_jags_mod <- jagsUI::jags(data = colt_jags_data,"
"0","             model.file = ""scripts/columbia_baci.txt"","
"0","             n.iter = 3000, n.burnin = 1000,"
"0","             parameters.to.save = c(""mean_pre"","
"0","                                    ""mean_dur"","
"0","                                    ""mean_post"","
"0","                                    ""ba_diff"","
"0","                                    ""beta0"","
"0","                                    ""beta.cov"","
"0","                                    ""sigma"","
"0","                                    ""sig_diff"","
"0","                                    ""tau"","
"0","                                    ""mean_month""),"
"0","             n.chains = 3, parallel = T, n.thin = 1"
"0","             ); colt_jags_mod"
"1","
Processing function input......."
"1"," "
"1","
"
"1","
Done."
"1"," "
"1","
"
"1"," "
"1","
"
"1","Beginning parallel processing using"
"1"," "
"1","3"
"1"," "
"1","cores. Console output will be suppressed.
"
"1","
Parallel processing completed.

"
"1","Calculating statistics......."
"1"," "
"1","
"
"1","
Done."
"1"," "
"1","
"
"1","JAGS output for model '"
"1",""
"1","scripts/columbia_baci.txt"
"1",""
"1","', generated by jagsUI."
"1",""
"1","
"
"1","Estimates based on"
"1"," "
"1","3"
"1"," "
"1","chains of"
"1"," "
"1","3000"
"1"," "
"1","iterations,
"
"1","adaptation ="
"1"," "
"1","100"
"1"," "
"1","iterations (sufficient),
"
"1","burn-in = "
"1",""
"1","1000"
"1",""
"1"," iterations and thin rate = "
"1",""
"1","1"
"1",""
"1",","
"1",""
"1","
"
"1","yielding"
"1"," "
"1","6000"
"1"," "
"1","total samples from the joint posterior."
"1"," "
"1","
"
"1","MCMC ran in parallel for "
"1",""
"1","0.165"
"1",""
"1"," minutes at time "
"1",""
"1","2025-12-17 16:03:35.393587"
"1",""
"1",".
"
"1",""
"1","
"
